version: "3"
services:
  webserver:
    build: .
    container_name: local-apache
    working_dir: /var/www
    volumes:
      - /etc/apache2/sites-available:/etc/apache2/sites-available:delegated
      - /var/www:/var/www:delegated
    command: /bin/bash -c "cat /etc/hosts && chmod +r -R /var/www && source /etc/apache2/envvars && a2ensite *drdplus* && echo 'ServerName localhost' >> /etc/apache2/apache2.conf && apache2 -D FOREGROUND"
    ports:
      - 8765:80
    # extra_hosts:
      # - "drdplus.loc:127.0.0.1"
      # - "www.drdplus.loc:127.0.0.1"
      # - "blog.drdplus.loc:127.0.0.1"
      # - "pph.drdplus.loc:127.0.0.1"
      # - "ppj.drdplus.loc:127.0.0.1"
      # - "bestiar.drdplus.loc:127.0.0.1"
      # - "bestiar.ppj.drdplus.loc:127.0.0.1"
      # - "zlodej.drdplus.loc:127.0.0.1"
      # - "hranicar.drdplus.loc:127.0.0.1"
      # - "rules.skeleton.drdplus.loc:127.0.0.1"
      # - "bojovnik.drdplus.loc:127.0.0.1"
      # - "knez.drdplus.loc:127.0.0.1"
      # - "carodej.drdplus.loc:127.0.0.1"
      # - "dobrodruzstvi.ppj.drdplus.loc:127.0.0.1"
      # - "pribeh.drdplus.loc:127.0.0.1"
      # - "pribeh.bestiar.drdplus.loc:127.0.0.1"
      # - "theurg.drdplus.loc:127.0.0.1"
      # - "kalkulator.skeleton.drdplus.loc:127.0.0.1"
      # - "formule.theurg.drdplus.loc:127.0.0.1"
      # - "pad.drdplus.loc:127.0.0.1"
      # - "utok.skeleton.drdplus.loc:127.0.0.1"
      # - "format.drdplus.loc:127.0.0.1"
      # - "boj.drdplus.loc:127.0.0.1"
      # - "niceni.drdplus.loc:127.0.0.1"
    labels:
      - "traefik.frontend.rule=Host:drdplus.loc,www.drdplus.loc,blog.drdplus.loc,pph.drdplus.loc,ppj.drdplus.loc,bestiar.drdplus.loc,bestiar.ppj.drdplus.loc,zlodej.drdplus.loc,hranicar.drdplus.loc,rules.skeleton.drdplus.loc,bojovnik.drdplus.loc,knez.drdplus.loc,carodej.drdplus.loc,dobrodruzstvi.ppj.drdplus.loc,pribeh.drdplus.loc,pribeh.bestiar.drdplus.loc,theurg.drdplus.loc,kalkulator.skeleton.drdplus.loc,formule.theurg.drdplus.loc,pad.drdplus.loc,utok.skeleton.drdplus.loc,format.drdplus.loc,boj.drdplus.loc,niceni.drdplus.loc"
      - "traefik.docker.network=docker-www"
    networks:
      - default
      - proxy

networks:
  proxy:
    external:
      name: docker-www
